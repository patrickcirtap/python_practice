import glob
import importlib
import re
import sys
sys.path.append("..")

if __name__ == "__main__":
    if("run_test.py" not in sys.argv):
        print("Test file can not be run directly - use run_test.py")
        sys.exit(1)

try:
    from run_test import Test
except RuntimeError:
    print(f"Error importing tester: {RuntimeError}")
    sys.exit(1)
try:
    challenge_module = glob.glob(f"c{sys.argv[1]}_*.py")[0]
    # Remove ".py" from file name
    challenge_module = challenge_module[:-3]
    # Remove "cN_" from file name
    challenge_function = re.sub(r'^.*?_', '', challenge_module)

    module = importlib.import_module(challenge_module)
    challenge_method = getattr(module, challenge_function)
except RuntimeError:
    print(f"Error importing challenge function: {RuntimeError}")
    sys.exit(1)

# List of all tests. Each test has form:
# ( (params_tuple), exp_result )
# Params must be tuple so they can be un-packed when called
tests = [
    (([2, 1, 4, 3],), [1, 2, 3, 4]),
    (([69, 420],), [69, 420]),
    (([-30, 8, -18, -42, -48, -52, -84, 72, 34, 0, -23, -55, -41],), [-84, -55, -52, -48, -42, -41, -30, -23, -18, 0, 8, 34, 72]),
    (([0],), [0]),
    (([204.35, 345.23, -955.82, -580.32, 63.85, 875.98, -391.59, -869.19, -903.5, 120.47, 611.63, 920.72, -884.76, 926.22, 16.8, 864.03, -113.23, -465.26, -251.56, 33.43, -120.5, -920.26, -802.04, -796.12, 846.7, -461.3],), [-955.82, -920.26, -903.5, -884.76, -869.19, -802.04, -796.12, -580.32, -465.26, -461.3, -391.59, -251.56, -120.5, -113.23, 16.8, 33.43, 63.85, 120.47, 204.35, 345.23, 611.63, 846.7, 864.03, 875.98, 920.72, 926.22]),
    (([-528.96908, -790.53614, -154.26305, 711.46875, 768.90349, -10.44177, 769.78462, -722.15279, 887.30645, -77.58889, -52.23939, 151.73212, 577.67283, -102.14652, 490.08607, -195.00164, 650.8863, 75.69908, -713.31591, -239.75658, -609.89833, 397.67047, 670.31528, 854.68964, 660.89392],), [-790.53614, -722.15279, -713.31591, -609.89833, -528.96908, -239.75658, -195.00164, -154.26305, -102.14652, -77.58889, -52.23939, -10.44177, 75.69908, 151.73212, 397.67047, 490.08607, 577.67283, 650.8863, 660.89392, 670.31528, 711.46875, 768.90349, 769.78462, 854.68964, 887.30645]),
    (([-130.954939, -294.258188, -826.422219, -249.834041, -350.580164, -110.735647, -107.145713, 630.499526, -633.032992, 115.554108, -359.151351, 718.595142, 929.572365, 54.837091],), [-826.422219, -633.032992, -359.151351, -350.580164, -294.258188, -249.834041, -130.954939, -110.735647, -107.145713, 54.837091, 115.554108, 630.499526, 718.595142, 929.572365]),
    (([-194.37, 389.04, -207.11, -513.86, 140.33, 503.83, -74.84, -759.94, -363.16, 501.14, -622.88, 588.35, -716.96, -894.69],), [-894.69, -759.94, -716.96, -622.88, -513.86, -363.16, -207.11, -194.37, -74.84, 140.33, 389.04, 501.14, 503.83, 588.35]),
    (([-38.5, -425.0, 463.8, -751.1, -844.6, 497.4, -541.3, 39.8, -104.0, 565.0, -492.1, 964.4, 813.6, -785.9, -130.5, -358.3, -793.4, -575.7, -591.1, -394.5, -538.9, 958.5, -136.6, 607.7],), [-844.6, -793.4, -785.9, -751.1, -591.1, -575.7, -541.3, -538.9, -492.1, -425.0, -394.5, -358.3, -136.6, -130.5, -104.0, -38.5, 39.8, 463.8, 497.4, 565.0, 607.7, 813.6, 958.5, 964.4]),
    (([974.610075, 744.159622, -384.80443, 275.951364, 465.7417, -944.17603, 678.890644, 207.442996, 219.98505, 26.873607, -766.914488, -546.417017, 847.871897, -368.301824, -656.488813, -214.765033, 764.856589, -427.203947, 736.172629, 168.65578, 95.30648, -310.479135, 189.869468, 242.486611, 575.330106, -429.881204],), [-944.17603, -766.914488, -656.488813, -546.417017, -429.881204, -427.203947, -384.80443, -368.301824, -310.479135, -214.765033, 26.873607, 95.30648, 168.65578, 189.869468, 207.442996, 219.98505, 242.486611, 275.951364, 465.7417, 575.330106, 678.890644, 736.172629, 744.159622, 764.856589, 847.871897, 974.610075]),
    (([88.2509087, -19.3873362, -107.2066241, -86.0022156, -944.7856589, -637.1320506, 582.2426751, 223.6059676, 408.4490999, -738.9027033, -802.0890587, -431.7766892, 273.2483713, -84.0076216, -565.2698438, -193.8745893, -754.2739291, 29.16772, -498.6251761, 459.3572524, -200.8948492, -556.0295613, 585.1288668],), [-944.7856589, -802.0890587, -754.2739291, -738.9027033, -637.1320506, -565.2698438, -556.0295613, -498.6251761, -431.7766892, -200.8948492, -193.8745893, -107.2066241, -86.0022156, -84.0076216, -19.3873362, 29.16772, 88.2509087, 223.6059676, 273.2483713, 408.4490999, 459.3572524, 582.2426751, 585.1288668]),
    (([902.58017, -724.5913, 809.07906, 441.86458, -867.9858, 180.54237, 423.89481, 983.42817, 690.5938, 95.22756, -521.89682, 355.15121],), [-867.9858, -724.5913, -521.89682, 95.22756, 180.54237, 355.15121, 423.89481, 441.86458, 690.5938, 809.07906, 902.58017, 983.42817]),
]

tester = Test(challenge_method, tests, challenge_module)
