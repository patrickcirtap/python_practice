import glob
import importlib
import re
import sys
sys.path.append("..")

if __name__ == "__main__":
    if("run_test.py" not in sys.argv):
        print("Test file can not be run directly - use run_test.py")
        sys.exit(1)

try:
    from run_test import Test
except RuntimeError:
    print(f"Error importing tester: {RuntimeError}")
    sys.exit(1)
try:
    challenge_module = glob.glob(f"c{sys.argv[1]}_*.py")[0]
    # Remove ".py" from file name
    challenge_module = challenge_module[:-3]
    # Remove "cN_" from file name
    challenge_function = re.sub(r'^.*?_', '', challenge_module)

    module = importlib.import_module(challenge_module)
    challenge_method = getattr(module, challenge_function)
except RuntimeError:
    print(f"Error importing challenge function: {RuntimeError}")
    sys.exit(1)

# List of all tests. Each test has form:
# ( (params_tuple), exp_result )
# Params must be tuple so they can be un-packed when called
tests = [
    (([165, 172, 174, 175, 181, 183], ), True),
    (([169, 175, 188, 183, 190], ), False),
    (([177], ), True),
    (([151, 153, 155, 159, 161, 163, 165, 166, 167, 168, 170, 176, 182, 184, 189, 190, 191, 198, 199, 200], ), True),
    (([153, 154, 157, 166, 169, 174, 175, 178, 180, 182, 183, 184, 186, 188, 193, 194, 196, 198, 199, 200], ), True),
    (([156, 161, 162, 163, 164, 166, 168, 169, 172, 174, 177, 178, 183, 187, 188, 189, 194, 195, 197, 199], ), True),
    (([150, 153, 154, 155, 161, 162, 167, 168, 169, 171, 176, 177, 181, 182, 183, 184, 189, 193, 196, 198], ), True),
    (([175, 169, 190, 160, 188, 198, 174, 166, 184, 165, 191, 167, 181, 156, 177, 164, 197, 155, 194, 168], ), False),
    (([169, 167, 165, 195, 200, 197, 177, 150, 171, 184, 181, 151, 156, 172, 179, 183, 196, 164, 185, 157], ), False),
    (([199, 180, 173, 196, 194, 198, 153, 190, 169, 162, 155, 186, 176, 166, 154, 192, 151, 177, 160], ), False),
    (([159, 152, 158, 180, 175, 189, 154, 157, 168, 156, 177, 198, 164, 160, 163, 173, 191, 200, 182, 196], ), False),
    (([187, 167, 190, 186, 154, 157, 193, 196, 191, 170, 197, 168, 183, 161, 173, 189, 199, 172, 177, 155], ), False),
    (([178, 161, 159, 164, 187, 199, 183, 189, 197, 167, 165, 181, 172, 169, 168, 162, 190, 175, 156, 150], ), False),
    (([151, 200, 155, 164, 192, 187, 178, 154, 185, 179, 173, 176, 169, 188, 160, 161, 174, 152, 199, 170], ), False),
    (([199, 176, 174, 181, 159, 169, 173, 168, 184, 172, 187, 162, 180, 178, 171, 190, 158, 152, 200, 182], ), False),
    (([166, 157, 169, 180, 171, 156, 200, 193, 179, 165, 161, 177, 163, 153, 198, 178, 195, 176, 191, 190], ), False),
    (([169, 200, 183, 189, 150, 190, 175, 168, 165, 178, 167, 163, 193, 156], ), False),
    (([153, 160, 165, 166, 169, 171, 172, 173, 176, 178, 181, 182, 184, 185, 187, 192, 193, 194, 195, 196], ), True),
    (([155, 156, 158, 159, 162, 163, 167, 169, 172, 173, 175, 179, 181, 182, 184, 185, 189, 194, 195, 196], ), True),
    (([150, 153, 154, 155, 156, 158, 163, 170, 171, 173, 175, 179, 181, 183, 184, 187, 189, 192, 198, 199], ), True),
    (([151, 152, 156, 158, 161, 162, 164, 165, 172, 178, 179, 182, 185, 186, 188, 191, 194, 197, 198], ), True),
    (([150, 153, 160, 161, 163, 164, 165, 169, 174, 175, 178, 179, 180, 183, 188, 189, 190, 195, 196, 198], ), True),
    (([150, 151, 154, 155, 158, 161, 166, 167, 168, 169, 171, 181, 182, 185, 186, 189, 190, 196, 197, 199], ), True),
]

tester = Test(challenge_method, tests, challenge_module)
